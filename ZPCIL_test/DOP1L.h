// ======================================================================    
// Допуски по нормам бокового зазора по ГОСТ 1643 - 81
// для Людиновского т.з - да введено RST5 - вид допуска на боковой зазор
// для всех остальных вид допуска совпадает с видом сопряжения
// Вид сопряжения          A  B  C  D  E H - KST4
// Вид допуска    x  y  z  a  b  c  d   h - KST5


extern int IST1, IST2, IST3, IST4, IST5;
void DOP1L(float M, float D[2], int KST[3], int KST4, int KST5, float FR[2], float EHS[2], float TH[2], 
           float EWS1[2], float EWS2[2], float EWS[2], float TWM[2], float TW[2], float ECS[2], float TC[2])  //M, D, KST, KST4, KST5, FR, EHS, TH, EWS1, EWS2, EWS, TWM, TW, ECS, TC)
{
    //     Допуски на радиальное биение FR (Табл. 6)
    
    int MFR[53][7] = { 6, 7, 8,  10,11,13,  16,18,20, 0,  25,28,32, 0,  36, 40, 45,  0,  0,  45, 50, 56,  0,  0,  0,   71, 80, 90,  0,  0,  0,  0,   100,125,140,  0,  0,  0,  0,  125,160,180,  0,  0,  0,  0,  160,200,224,  0,  0,  0,  0,    // 53 значения 
                       9,10,11,  15,16,18,  22,25,28,32,  36,40,45,50,  50, 56, 63, 71, 80,  63, 71, 80, 90,100,  0,   80,100,112,125,160,  0,  0,   112,140,160,180,224,  0,  0,  140,180,200,224,280,  0,  0,  180,224,250,280,355,  0,  0,
                      11,13,14,  18,20,22,  28,32,36,40,  45,50,56,63,  63, 71, 80, 90,100,  80, 90,100,112,125,140,  100,112,125,160,200,250,315,   125,140,160,200,250,315,400,  160,180,200,250,315,400,500,  200,224,250,315,400,500,630,
                      13,14,16,  20,22,25,  32,36,40,45,  50,56,63,71,  71, 80, 90,100,112,  90,100,112,125,140,160,  112,125,140,160,200,250,315,   140,160,180,200,250,315,400,  180,200,224,250,315,400,500,  224,250,280,315,400,500,630,
                      14,16,18,  22,25,28,  36,40,45,50,  56,63,71,80,  80, 90,100,112,125, 100,112,125,140,160,190,  125,140,160,180,224,280,355,   160,180,200,224,280,355,450,  200,224,250,280,355,450,560,  250,280,315,355,450,560,710,
                      0, 18,20,  0, 28,32,  0, 45,50,56,  0, 71,80,90,   0,100,112,125,140,  0, 125,140,160,180,224,   0, 160,180,200,224,280,355,    0, 200,224,250,280,355,450,   0, 250,280,315,355,450,560,   0, 315,355,400,450,560,710,
                      0, 0, 22,  0, 0, 36,  0, 0, 56,63,  0, 0, 90,100,  0,  0,125,140,160,  0,   0,160,180,200,250,   0,  0, 200,224,250,315,400,    0,  0, 250,280,315,400,500,   0,  0, 315,355,400,500,630,   0,  0, 400,450,500,630,800 };
    
    //     Наименьшее дополнительное смещение исходного контура EHS(Табл. 14)
    
    //int LMEHS1[336] = 
    int MEHS[24][18] = { 12, 14,    30, 35,    46, 50, 55,    74, 80, 90, 100,   120, 140, 140, 160, 160, 180,    190, 200, 220, 250, 280, 280, 300,
                        14, 16,    35, 40,    54, 60, 70,    87,100,110, 120,   140, 160, 160, 180, 200, 220,    220, 250, 280, 280, 300, 350, 350,
                        16, 18,    40, 45,    63, 70, 80,   100,110,120, 140,   160, 180, 200, 200, 220, 250,    250, 280, 300, 350, 350, 400, 450,
                        18, 20,    46, 50,    72, 80, 90,   115,120,140, 160,   185, 200, 220, 250, 250, 280,    290, 300, 350, 400, 400, 450, 500,
                        20, 22,    52, 55,    81, 90,100,   130,140,160, 180,   210, 250, 250, 280, 300, 300,    320, 350, 400, 400, 450, 500, 500,
                        22, 25,    57, 60,    89,100,110,   140,160,180, 200,   230, 250, 280, 300, 350, 350,    360, 400, 450, 500, 500, 550, 600,
                        25, 28,    63, 70,    97,110,120,   155,180,200, 200,   250, 280, 300, 350, 350, 400,    400, 450, 500, 500, 600, 600, 700,
                        28, 30,    70, 80,   110,120,140,   175,200,220, 250,   280, 300, 350, 400, 400, 400,    440, 500, 550, 600, 600, 700, 700,
                        30, 35,    80, 90,   125,140,160,   200,220,250, 280,   320, 350, 400, 400, 450, 500,    500, 550, 600, 700, 700, 800, 800,
                        40, 45,    90,100,   140,160,180,   230,250,280, 300,   360, 400, 450, 450, 500, 550,    560, 600, 700, 800, 800, 900, 900,
                        45, 50,   105,120,   165,180,200,   260,280,300, 350,   420, 450, 500, 550, 600, 600,    660, 700, 800, 900, 900,1000,1100,
                        50, 55,   125,140,   195,220,250,   310,350,400, 450,   500, 550, 600, 700, 700, 800,    780, 900, 900,1000,1100,1200,1200,
                        60, 70,   150,160,   230,250,280,   370,400,450, 500,   600, 700, 700, 800, 800, 900,    920,1000,1100,1200,1400,1400,1600,
                        70, 80,   175,200,   280,300,350,   440,450,500, 600,   700, 800, 800, 900,1000,1100,   1100,1200,1400,1400,1600,1600,1800, 
    //};
    //int LMEHS2[96] = {  
                        80, 90,   210, 240,  330,350,400,   540,600,600, 700,    860, 900,1000,1100,1200,1200,   1350,1400,1600,1800,1800,2000,2200,
                       100,110,   260, 280,  410,450,500,   660,700,800, 900,   1050,1100,1200,1400,1400,1600,   1650,1800,2000,2200,2200,2500,2800,
                       120, 140,  320, 350,  500,550,600,   800,900,1000,1000,  1300,1400,1600,1800,1800,2000,   2000,2200,2400,2500,2800,3000,3500,
                       160, 180,  400, 450,  620,700,750,   980,1100,1200,1200, 1550,1800,1800,2000,2200,2400,   2500,2800,3000,3500,3500,4000,4000 };
    
    //    Допуски на смещение исходного контура TH (Табл. 15)

    int MTH[8][21] = {
         28,   35,   45,   55,   70,   90,  110,  140, 
         30,   40,   50,   60,   80,  100,  120,  160, 
         35,   40,   55,   70,   80,  100,  140,  160, 
         40,   45,   60,   70,   90,  110,  140,  180,
         40,   55,   70,   80,  100,  120,  160,  200, 
         45,   60,   80,   90,  110,  140,  180,  220,
         55,   70,   90,  100,  140,  160,  200,  250, 
         60,   80,  100,  120,  160,  180,  250,  300,
         70,   90,  120,  140,  180,  220,  280,  350,
         80,  100,  140,  180,  200,  250,  350,  400,
        110,  140,  180,  200,  250,  300,  400,  500,
        120,  160,  200,  250,  300,  350,  500,  600,
        160,  200,  250,  300,  350,  450,  600,  700,
        200,  250,  300,  400,  450,  550,  700,  900,
        250,  300,  400,  500,  550,  700,  900, 1100,
        300,  350,  500,  600,  700,  900, 1000, 1400,
        450,  450,  600,  700,  900, 1100, 1400, 1800,
        450,  600,  700,  900, 1100, 1400, 1600, 2000,
        550,  700,  900, 1100, 1400, 1600, 2000, 2500,
        700,  900, 1200, 1400, 1600, 2000, 2500, 3000,
        900, 1200, 1400, 1800, 2000, 2500, 3500, 4000 };
 
    
    //     Наименьшее отклонение средней длины общей нормали(слагаемое 1)
    //     или наименьшее отклонение длины общей нормали EWS1(Табл. 16)

    int MEWS1[24][12] = {  8, 10, 20,  25,  30,  35,  40,  50,  55,  60,  70,  80, 100, 100, 110, 110, 120, 120, 140, 160, 180, 200, 200, 200,
                          10, 10, 24,  30,  35,  40,  50,  60,  70,  80,  80, 100, 110, 110, 120, 140, 160, 140, 180, 200, 200, 200, 250, 250,
                          11, 12, 28,  30,  40,  50,  50,  70,  70,  80, 100, 110, 120, 140, 140, 160, 180, 180, 200, 200, 250, 250, 280, 300,
                          12, 14, 30,  35,  50,  55,  60,  80,  80, 100, 110, 120, 140, 140, 160, 180, 200, 200, 200, 250, 280, 280, 300, 350,
                          14, 16, 35,  40,  55,  60,  70,  90, 100, 110, 120, 140, 140, 180, 200, 200, 200, 220, 250, 280, 280, 300, 350, 350,
                          16, 18, 40,  45,  60,  70,  70, 100, 110, 120, 140, 160, 180, 200, 200, 250, 250, 250, 280, 300, 350, 350, 350, 400,
                          18, 20, 45,  50,  70,  70,  80, 110, 120, 140, 140, 180, 200, 200, 250, 250, 280, 280, 300, 350, 350, 400, 400, 500,
                          20, 22, 50,  55,  70,  80,  90, 120, 140, 140, 160, 200, 200, 250, 280, 280, 280, 300, 350, 350, 400, 400, 500, 500,
                          22, 25, 55,  60,  90, 100, 110, 140, 140, 160, 200, 220, 250, 280, 300, 350, 350, 350, 350, 400, 500, 500, 550, 550,
                          25, 28, 60,  70, 100, 110, 120, 160, 160, 200, 200, 250, 280, 300, 300, 350, 350, 400, 400, 500, 550, 550, 600, 600,
                          28, 30, 70,  80, 110, 120, 140, 180, 200, 200, 250, 280, 300, 350, 350, 400, 400, 500, 500, 550, 600, 600, 700, 800,
                          35, 40, 90, 100, 140, 160, 180, 220, 250, 280, 300, 350, 400, 400, 500, 500, 500, 550, 600, 600, 700, 800, 800, 800 };

    //     Наименьшие отклонения средней длины общей нормали(слагаемое 2) EWS2(Табл. 17)

    int MEWS2[21] = { 2, 2, 3, 3, 4, 5, 7, 9, 11, 14, 18, 22, 25, 35, 45, 55, 70, 90, 110, 140, 180 };

    //     Допуски на среднюю длину общей нормали TWM (Табл. 18)

    int MTWM[8][21] = { 16,  20,  28,  35,   45,   60,   70,   90,
                        16,  25,  30,  40,   50,   60,   80,  100,
                        18,  25,  30,  40,   50,   60,   90,  100,
                        20,  25,  35,  40,   55,   70,   90,  110,
                        20,  28,  40,  45,   60,   70,  100,  120,
                        20,  30,  45,  50,   60,   80,  110,  140,
                        22,  35,  45,  55,   80,  100,  120,  160,
                        25,  40,  50,  60,   90,  110,  160,  180,
                        25,  40,  60,  70,  100,  120,  180,  220,
                        28,  40,  70, 100,  110,  140,  220,  250,
                        30,  60,  90, 100,  140,  180,  240,  300,
                        40,  70, 110, 120,  150,  200,  300,  350,
                        55,  80, 120, 140,  180,  250,  350,  400,
                        70, 100, 140, 200,  240,  300,  400,  550,
                        80, 120, 180, 250,  280,  400,  500,  700,
                       100, 140, 240, 300,  350,  500,  600,  800,
                       100, 160, 280, 350,  450,  600,  800, 1100,
                       140, 240, 300, 450,  550,  800,  900, 1200,
                       160, 250, 400, 550,  700,  800, 1100, 1400,
                       200, 350, 550, 700,  800, 1100, 1400, 1800,
                       280, 500, 600, 900, 1000, 1400, 2000, 2400 };

    //     Допуски на длину общей нормали TW (Табл. 19)

    int MTW[8][21] = { 20, 25, 35, 35, 50, 60, 80, 100, 
                       20, 28, 35, 40, 55, 70, 80, 110,
                       25, 28, 35, 50, 55, 70, 100, 110, 
                       28, 30, 40, 50, 60, 70, 100, 120,
                       28, 35, 50, 55, 70, 80, 110, 140, 
                       30, 40, 55, 60, 80, 100, 120, 140,
                       35, 50, 60, 70, 100, 110, 140, 180, 
                       40, 55, 70, 80, 110, 120, 180, 200,
                       50, 60, 80, 100, 120, 140, 200, 250, 
                       60, 70, 100, 120, 140, 180, 250, 280,
                       70, 100, 120, 140, 180, 200, 280, 350,
                       80, 110, 140, 180, 200, 250, 350, 400,
                      100, 140, 180, 200, 250, 300, 400, 500,
                      140, 180, 200, 280, 300, 350, 500, 600,
                      160, 200, 280, 350, 350, 500, 600, 800,
                      200, 250, 350, 400, 500, 600, 800, 1000,
                      250, 300, 400, 500, 600, 800, 1000, 1200,
                      300, 400, 500, 600, 700, 1000, 1100, 1400,
                      400, 500, 600, 700, 1000, 110, 1400, 1800,
                      450, 600, 700, 1000, 1100, 1400, 1800, 2000,
                      600, 700, 1000, 1200, 1400, 1800, 2500, 2800 };
    
    //    Наименьшее отклонение толщины зуба ECS (Табл. 20)

    //int LMECS1[336] = 
    int MECS[24][18] = {9, 10,    22, 25,    35, 35, 40,    55,  60,  70,  70,  90, 100, 100, 120, 120, 140,     140, 150, 160, 180, 200, 200, 220,
                       10, 12,    25, 30,    40, 45, 50,    60,  70,  80,  90, 100, 120, 120, 140, 140, 160,     160, 180, 200, 200, 220, 240, 250, 
                       12, 14,    30, 35,    45, 50, 60,    70,  80,  90, 100, 120, 140, 140, 160, 180, 180,     180, 200, 220, 250, 250, 300, 350, 
                       14, 14,    35, 35,    55, 60, 70,    80,  90, 100, 120, 140, 140, 160, 180, 180, 200,     200, 220, 250, 300, 300, 350, 350, 
                       16, 16,    40, 40,    60, 70, 70,    90, 100, 120, 140, 160, 180, 180, 200, 220, 220,     250, 250, 300, 300, 350, 350, 350, 
                       16, 18,    40, 45,    60, 70, 80,   100, 120, 140, 140, 160, 180, 200, 220, 250, 250,     250, 300, 350, 350, 350, 400, 450, 
                       18, 20,    45, 50,    70, 80, 90,   110, 140, 140, 140, 180, 200, 220, 250, 250, 300,     300, 350, 350, 350, 450, 450, 500, 
                       20, 22,    50, 60,    80, 90, 100,  120, 140, 160, 180, 200, 220, 250, 300, 300, 300,     300, 350, 400, 450, 450, 500, 500, 
                       22, 25,    60, 70,    90,100, 120,  140, 160, 180, 200, 220, 250, 300, 300, 350, 350,     350, 400, 450, 500, 500, 600, 600, 
                       30, 35,    70, 70,   100,120, 140,  160, 180, 200, 220, 250, 300, 350, 350, 400, 400,     400, 450, 500, 600, 600, 700, 700, 
                       35, 35,    80, 90,   120,140, 140,  180, 200, 220, 250, 300, 350, 350, 400, 450, 450,     500, 500, 600, 700, 700, 700, 800, 
                       35, 40,    90, 100,  140,160, 180,  220, 250, 300, 350, 350, 400, 450, 500, 500, 600,     600, 700, 700, 700, 800, 900, 900, 
                       45, 50,   110, 120,  180,180, 200,  250, 300, 350, 350, 400, 500, 500, 600, 600, 800,     700, 700, 800, 900,1000,1000,1200, 
                       50, 60,   120, 140,  200,220, 250,  300, 350, 400, 450, 500, 600, 600, 700, 700, 900,     800, 900,1000,1000,1200,1200,1400,
    //};
    //int LMECS2[96] = {         
                       60, 70,   160, 180,  240,250, 300,  400, 450, 500, 500, 600, 700, 700, 800, 900, 900,    1000,1000,1200,1400,1400,1400,1600, 
                       70, 80,   180, 200,  300,350, 350,  500, 500, 600, 600, 800, 800, 900,1000,1000,1200,    1200,1400,1400,1600,1600,1800,2000, 
                       90,100,   240, 250,  350,400, 450,  600, 700, 700, 700, 900,1000,1200,1400,1400,1400,    1400,1600,1800,1800,2000,2200,2500, 
                      120,140,   300, 350,  450,500, 550,  700, 800, 900, 900,1100,1400,1400,1400,1600,1800,    1800,2000,2200,2500,2500,3000,3000 };
        
        //    Допуски на толщину зуба TC (Табл. 21)
        
    int MTC[8][21] = {
            20, 25, 35, 40, 50, 70, 80, 100, 
            22, 30, 35, 45, 60, 70, 90, 120,
            25, 30, 35, 50, 60, 70, 100, 120, 
            30, 35, 45, 50, 70, 80, 100, 140,
            30, 40, 50, 60, 70, 90, 120, 140, 
            35, 45, 60, 70, 80, 100, 140, 160,
            40, 50, 70, 70, 100, 140, 140, 180, 
            45, 60, 70, 90, 120, 140, 180, 220,
            50, 70, 90, 100, 140, 160, 200, 250, 
            70, 70, 100, 120, 140, 180, 250, 300,
            70, 100, 140, 140, 180, 220, 300, 350,
            90, 120, 160, 180, 220, 250, 350, 450,
            120, 140, 180, 220, 250, 350, 450, 500,
            140, 180, 220, 300, 350, 400, 500, 700,
            180, 220, 300, 350, 400, 500, 700, 800,
            220, 250, 350, 450, 500, 700, 800, 1000,
            250, 350, 450, 500, 700, 800, 1000, 1400,
            350, 450, 500, 700, 800, 1000, 1200, 1400,
            400, 500, 700, 800, 1000, 1200, 1400, 1800,
            500, 700, 900, 1000, 1200, 1400, 1800, 2200,
            700, 700, 1000, 1400, 1400, 1800, 2500, 3000 };

    //     OПPEДEЛEHИE ИHДEKCOB
    //    CCC      IF(M.LE.55.) IM = 7
    int IMF = 0;
    int IM = 7;
    int IS = 0;
    int IVS = 0;
    int IV = 0;
    int IVD = 0;
    int IDF = 0;
    int IDE = 0;
    int IDW = 0;
    int IFR = 0;

    if (M <= 40.) IM = 6;
    if (M <= 25.) IM = 5;
    if (M <= 16.) IM = 4;
    if (M <= 10.) IM = 3;
    if (M <= 6.3) IM = 2;
    if (M <= 3.5) IM = 1;
    if (KST[0] == 3) IMF = IM;
    if (KST[0] == 4) IMF = IM + 3;
    if (KST[0] == 5) IMF = IM + 6;
    if (KST[0] == 6) IMF = IM + 10;
    if (KST[0] == 7) IMF = IM + 14;
    if (KST[0] == 8) IMF = IM + 19;
    if (KST[0] == 9) IMF = IM + 25;
    if (KST[0] == 10) IMF = IM + 32;
    if (KST[0] == 11) IMF = IM + 39;
    if (KST[0] == 12) IMF = IM + 46;
    if (KST[1] <= 6) IS = 1;
    if (KST[1] >= 7) IS = KST[1] - 5;
    if (KST4 == 6) IVS = IS;
    if (KST4 == 5) IVS = IS + 2;
    if (KST4 == 4) IVS = IS + 4;
    if (KST4 == 3) IVS = IS + 7;
    if (KST4 == 2) IVS = IS + 11;
    if (KST4 == 1) IVS = IS + 17;
    IV = 7 - KST4;
    IVD = 9 - KST5;
    for (int i = 0; i < 2; i++) {

     //   CCCC      if (D[i] <= 6300.) IDF = 7;
        IDF = 7;
        if (D[i] <= 4000.) IDF = 6;
        if (D[i] <= 2500.) IDF = 5;
        if (D[i] <= 1600.) IDF = 4;
        if (D[i] <= 800.) IDF = 3;
        if (D[i] <= 400.) IDF = 2;
        if (D[i] <= 125.) IDF = 1;
     //   CCCC      if (D[i] <= 6300.) IDE = 18;
        IDE = 18;
        if (D[i] <= 5000.) IDE = 17;
        if (D[i] <= 4000.) IDE = 16;
        if (D[i] <= 3150.) IDE = 15;
        if (D[i] <= 2500.) IDE = 14;
        if (D[i] <= 2000.) IDE = 13;
        if (D[i] <= 1600.) IDE = 12;
        if (D[i] <= 1250.) IDE = 11;
        if (D[i] <= 1000.) IDE = 10;
        if (D[i] <= 800.) IDE = 9;
        if (D[i] <= 630.) IDE = 8;
        if (D[i] <= 500.) IDE = 7;
        if (D[i] <= 400.) IDE = 6;
        if (D[i] <= 315.) IDE = 5;
        if (D[i] <= 250.) IDE = 4;
        if (D[i] <= 180.) IDE = 3;
        if (D[i] <= 125.) IDE = 2;
        if (D[i] <= 80.) IDE = 1;
    //    CCCC      if (D[i] <= 1600.) IDW = 12;
        IDW = 12;
        if (D[i] <= 1250.) IDW = 11;
        if (D[i] <= 1000.) IDW = 10;
        if (D[i] <= 800.) IDW = 9;
        if (D[i] <= 630.) IDW = 8;
        if (D[i] <= 500.) IDW = 7;
        if (D[i] <= 400.) IDW = 6;
        if (D[i] <= 315.) IDW = 5;
        if (D[i] <= 250.) IDW = 4;
        if (D[i] <= 180.) IDW = 3;
        if (D[i] <= 125.) IDW = 2;
        if (D[i] <= 80.) IDW = 1;
        FR[i] = MFR[IMF-1][IDF-1];
        if (FR[i] <= 800.) IFR = 21;
        if (FR[i] <= 630) IFR = 20;
        if (FR[i] <= 500.) IFR = 19;
        if (FR[i] <= 400.) IFR = 18;
        if (FR[i] <= 320.) IFR = 17;
        if (FR[i] <= 250.) IFR = 16;
        if (FR[i] <= 200.) IFR = 15;
        if (FR[i] <= 160) IFR = 14;
        if (FR[i] <= 125.) IFR = 13;
        if (FR[i] <= 100.) IFR = 12;
        if (FR[i] <= 80.) IFR = 11;
        if (FR[i] <= 60.) IFR = 10;
        if (FR[i] <= 50.) IFR = 9;
        if (FR[i] <= 40.) IFR = 8;
        if (FR[i] <= 32.) IFR = 7;
        if (FR[i] <= 25.) IFR = 6;
        if (FR[i] <= 20.) IFR = 5;
        if (FR[i] <= 16.) IFR = 4;
        if (FR[i] <= 12.) IFR = 3;
        if (FR[i] <= 10.) IFR = 2;
        if (FR[i] <= 8.) IFR = 1;
        
        //     Определение допусков и отклонений

        EHS[i] = - MEHS[IVS - 1][IDE - 1] / 1000.;
        TH[i] = MTH[IVD - 1][IFR - 1] / 1000.;
        EWS1[i] = -MEWS1[IVS - 1][IDW - 1] / 1000.;
        EWS2[i] = -MEWS2[IFR] / 1000.;
        EWS[i] = EWS1[i] + EWS2[i];
        TWM[i] = MTWM[IVD - 1][IFR - 1] / 1000.;
        TW[i] = MTW[IVD - 1][IFR - 1] / 1000.;
        ECS[i] = -MECS[IVS - 1][IDE - 1] / 1000.;
        TC[i] = MTC[IVD - 1][IFR - 1] / 1000.;
    }
    /*
    C     Допуски по нормам бокового зазора по ГОСТ 1643 - 81
    C для Людиновского т.з - да введено RST5 - вид допуска на боковой зазор
    C для всех остальных вид допуска совпадает с видом сопряжения
    C Вид сопряжения          A  B  C  D  E H - KST4
    C Вид допуска    x  y  z  a  b  c  d   h - KST5
    REAL M
    DIMENSION D(2), KST(3), FR(2), EHS(2), TH(2), EWS1(2), EWS2(2),
    * EWS(2), TWM(2), TW(2), ECS(2), TC(2),
    * MFR(53, 7), MEHS(24, 18), MTH(8, 21), MEWS1(24, 12), MEWS2(21),
    * MTWM(8, 21), MTW(8, 21), MECS(24, 18), MTC(8, 21),
    * LMEHS1(336), LMEHS2(96), LMECS1(336), LMECS2(96)
    EQUIVALENCE(MECS(1, 1), LMECS1(1)), (MECS(1, 15), LMECS2(1))
    EQUIVALENCE(MEHS(1, 1), LMEHS1(1))
    EQUIVALENCE(MEHS(1, 15), LMEHS2(1))
    SAVE
    C     Ввод начальных данных


    C     Наименьшее дополнительное смещение исходного контура EHS(TAbl.14)
    DATA LMEHS1 / 12, 14, 30, 35, 46, 50, 55, 74, 80, 90, 100, 120, 2 * 140, 2 * 160, 180,    
    * 190, 200, 220, 250, 2 * 280, 300, 14, 16, 35, 40, 54, 60, 70, 87, 100, 110, 120, 140,
    * 2 * 160, 180, 200, 2 * 220, 250, 2 * 280, 300, 2 * 350, 16, 18, 40, 45, 63, 70, 80, 100,
    * 110, 120, 140, 160, 180, 2 * 200, 220, 2 * 250, 280, 300, 2 * 350, 400, 450, 18, 20,
    * 46, 50, 72, 80, 90, 115, 120, 140, 160, 185, 200, 220, 2 * 250, 280, 290, 300, 350,
    * 2 * 400, 450, 500, 20, 22, 52, 55, 81, 90, 100, 130, 140, 160, 180, 210, 2 * 250, 280,
    * 2 * 300, 320, 350, 2 * 400, 450, 2 * 500, 22, 25, 57, 60, 89, 100, 110, 140, 160, 180,
    * 200, 230, 250, 280, 300, 2 * 350, 360, 400, 450, 2 * 500, 550, 600, 25, 28, 63, 70,
    * 97, 110, 120, 155, 180, 2 * 200, 250, 280, 300, 2 * 350, 2 * 400, 450, 2 * 500, 2 * 600,
    * 700, 28, 30, 70, 80, 110, 120, 140, 175, 200, 220, 250, 280, 300, 350, 3 * 400, 440,
    * 500, 550, 2 * 600, 2 * 700, 30, 35, 80, 90, 125, 140, 160, 200, 220, 250, 280, 320,
    * 350, 2 * 400, 450, 2 * 500, 550, 600, 2 * 700, 2 * 800, 40, 45, 90, 100, 140, 160, 180,
    * 230, 250, 280, 300, 360, 400, 2 * 450, 500, 550, 560, 600, 700, 2 * 800, 2 * 900, 45,
    * 50, 105, 120, 165, 180, 200, 260, 280, 300, 350, 420, 450, 500, 550, 2 * 600, 660,
    * 700, 800, 900, 900, 1000, 1100, 50, 55, 125, 140, 195, 220, 250, 310, 350, 400,
    * 450, 500, 550, 600, 700, 700, 800, 780, 2 * 900, 1000, 1100, 2 * 1200, 60, 70, 150,
    * 160, 230, 250, 280, 370, 400, 450, 500, 600, 2 * 700, 2 * 800, 900, 920, 1000,
    * 1100, 1200, 2 * 1400, 1600, 70, 80, 175, 200, 280, 300, 350, 440, 450, 500, 600,
    * 700, 2 * 800, 900, 1000, 2 * 1100, 1200, 2 * 1400, 2 * 1600, 1800 /
    * 
    DATA LMEHS2 / 80, 90, 210, 240, 330, 350, 400, 540, 2 * 600, 700, 860, 900, 1000,
    * 1100, 2 * 1200, 1350, 1400, 1600, 2 * 1800, 2000, 2200,
    * 100, 110, 260, 280, 410, 450,
    * 500, 660, 700, 800, 900, 1050, 1100, 1200, 2 * 1400, 1600, 1650, 1800, 2000,
    * 2 * 2200, 2500, 2800, 120, 140, 320, 350, 500, 550, 600, 800, 900, 2 * 1000,
    * 1300, 1400, 1600, 2 * 1800, 2 * 2000, 2200, 2400, 2500, 2800, 3000, 3500,
    * 160, 180, 400, 450, 620, 700, 750, 980, 1100, 2 * 1200, 1550, 2 * 1800, 2000, 2200,
    * 2400, 2500, 2800, 3000, 2 * 3500, 2 * 4000 /
    C     Допуски на смещение исходного контура TH(TAbl.15)
    DATA MTH /
    *28, 35, 45, 55, 70, 90, 110, 140, 30, 40, 50, 60, 80, 100, 120, 160,
    * 35, 40, 55, 70, 80, 100, 140, 160, 40, 45, 60, 70, 90, 110, 140, 180,
    * 40, 55, 70, 80, 100, 120, 160, 200, 45, 60, 80, 90, 110, 140, 180, 220,
    * 55, 70, 90, 100, 140, 160, 200, 250, 60, 80, 100, 120, 160, 180, 250, 300,
    * 70, 90, 120, 140, 180, 220, 280, 350,
    * 80, 100, 140, 180, 200, 250, 350, 400,
    * 110, 140, 180, 200, 250, 300, 400, 500,
    * 120, 160, 200, 250, 300, 350, 500, 600,
    * 160, 200, 250, 300, 350, 450, 600, 700,
    * 200, 250, 300, 400, 450, 550, 700, 900,
    * 250, 300, 400, 500, 550, 700, 900, 1100,
    * 300, 350, 500, 600, 700, 900, 1000, 1400,
    * 450, 450, 600, 700, 900, 1100, 1400, 1800,
    * 450, 600, 700, 900, 1100, 1400, 1600, 2000,
    * 550, 700, 900, 1100, 1400, 1600, 2000, 2500,
    * 700, 900, 1200, 1400, 1600, 2000, 2500, 3000,
    * 900, 1200, 1400, 1800, 2000, 2500, 3500, 4000 /
    
    C     Наименьшее отклонение средней длины общей нормали (слагаемое 1)
    C     или наименьшее отклонение длины общей нормали EWS1(TAbl.16)

        DATA MEWS1 / 8, 10, 20, 25, 30, 35, 40, 50, 55, 60, 70, 80, 2 * 100, 2 * 110, 2 * 120,
        * 140, 160, 180, 3 * 200, 2 * 10, 24, 30, 35, 40, 50, 60, 70, 2 * 80, 100, 2 * 110, 120,
        * 140, 160, 140, 180, 3 * 200, 2 * 250, 11, 12, 28, 30, 40, 2 * 50, 2 * 70, 80, 100, 110,
        * 120, 2 * 140, 160, 2 * 180, 2 * 200, 2 * 250, 280, 300, 12, 14, 30, 35, 50, 55, 60,
        * 2 * 80, 100, 110, 120, 2 * 140, 160, 180, 3 * 200, 250, 2 * 280, 300, 350, 14, 16, 35, 40
        *, 55, 60, 70, 90, 100, 110, 120, 140, 2 * 180, 3 * 200, 220, 250, 2 * 280, 300, 2 * 350,
        * 16, 18, 40, 45, 60, 2 * 70, 100, 110, 120, 140, 160, 180, 2 * 200, 3 * 250, 280, 300,
        * 3 * 350, 400, 18, 20, 45, 50, 2 * 70, 80, 110, 120, 2 * 140, 180, 2 * 200, 2 * 250, 2 * 280,
        * 300, 2 * 350, 2 * 400, 500, 20, 22, 50, 55, 70, 80, 90, 120, 2 * 140, 160, 2 * 200, 250,
        * 3 * 280, 300, 2 * 350, 2 * 400, 2 * 500, 22, 25, 55, 60, 90, 100, 110, 2 * 140, 160, 200,
        * 220, 250, 280, 300, 4 * 350, 400, 2 * 500, 2 * 550, 25, 28, 60, 70, 100, 110, 120,
        * 2 * 160, 2 * 200, 250, 280, 2 * 300, 2 * 350, 2 * 400, 500, 2 * 550, 2 * 600, 28, 30, 70, 80,
        * 110, 120, 140, 180, 2 * 200, 250, 280, 300, 2 * 350, 2 * 400, 2 * 500, 550, 2 * 600,
        * 700, 800, 35, 40, 90, 100, 140, 160, 180, 220, 250, 280, 300, 350, 2 * 400,
        * 3 * 500, 550, 2 * 600, 700, 3 * 800 /
        
        C     Наименьшие отклонения средней длины общей нормали (слагаемое 2) EWS2(TAbl.17)

        DATA MEWS2 / 2, 2, 3, 3, 4, 5, 7, 9, 11, 14, 18, 22, 25, 35,
        * 45, 55, 70, 90, 110, 140, 180 /
        C     Допуски на среднюю длину общей нормали TWM(TAbl.18)

DATA MTWM /
*16, 20, 28, 35, 45, 60, 70, 90, 16, 25, 30, 40, 50, 60, 80, 100,
* 18, 25, 30, 40, 50, 60, 90, 100, 20, 25, 35, 40, 55, 70, 90, 110,
* 20, 28, 40, 45, 60, 70, 100, 120, 20, 30, 45, 50, 60, 80, 110, 140,
* 22, 35, 45, 55, 80, 100, 120, 160, 25, 40, 50, 60, 90, 110, 160, 180,
* 25, 40, 60, 70, 100, 120, 180, 220, 28, 40, 70, 100, 110, 140, 220, 250,
* 30, 60, 90, 100, 140, 180, 240, 300, 40, 70, 110, 120, 150, 200, 300, 350,
* 55, 80, 120, 140, 180, 250, 350, 400,
* 70, 100, 140, 200, 240, 300, 400, 550,
* 80, 120, 180, 250, 280, 400, 500, 700,
* 100, 140, 240, 300, 350, 500, 600, 800,
* 100, 160, 280, 350, 450, 600, 800, 1100,
* 140, 240, 300, 450, 550, 800, 900, 1200,
* 160, 250, 400, 550, 700, 800, 1100, 1400,
* 200, 350, 550, 700, 800, 1100, 1400, 1800,
* 280, 500, 600, 900, 1000, 1400, 2000, 2400 /
C     ДOПУCKИ HA ДЛИНУ общей нормали TW(TAbl.19)
DATA MTW /
*20, 25, 35, 35, 50, 60, 80, 100, 20, 28, 35, 40, 55, 70, 80, 110,
* 25, 28, 35, 50, 55, 70, 100, 110, 28, 30, 40, 50, 60, 70, 100, 120,
* 28, 35, 50, 55, 70, 80, 110, 140, 30, 40, 55, 60, 80, 100, 120, 140,
* 35, 50, 60, 70, 100, 110, 140, 180, 40, 55, 70, 80, 110, 120, 180, 200,
* 50, 60, 80, 100, 120, 140, 200, 250, 60, 70, 100, 120, 140, 180, 250, 280,
* 70, 100, 120, 140, 180, 200, 280, 350,
* 80, 110, 140, 180, 200, 250, 350, 400,
* 100, 140, 180, 200, 250, 300, 400, 500,
* 140, 180, 200, 280, 300, 350, 500, 600,
* 160, 200, 280, 350, 350, 500, 600, 800,
* 200, 250, 350, 400, 500, 600, 800, 1000,
* 250, 300, 400, 500, 600, 800, 1000, 1200,
* 300, 400, 500, 600, 700, 1000, 1100, 1400,
* 400, 500, 600, 700, 1000, 110, 1400, 1800,
* 450, 600, 700, 1000, 1100, 1400, 1800, 2000,
* 600, 700, 1000, 1200, 1400, 1800, 2500, 2800 /
C     Наименьшее отклонение толщины зуба ECS(TAbl.20)
DATA LMECS1 / 9, 10, 22, 25, 2 * 35, 40, 55, 60, 2 * 70, 90, 2 * 100, 2 * 120, 2 * 140,
* 150, 160, 180, 2 * 200, 220, 10, 12, 25, 30, 40, 45, 50, 60, 70, 80, 90, 100, 2 * 120,
* 2 * 140, 2 * 160, 180, 2 * 200, 220, 240, 250, 12, 14, 30, 35, 45, 50, 60, 70, 80, 90,
* 100, 120, 2 * 140, 160, 3 * 180, 200, 220, 2 * 250, 300, 350, 2 * 14, 2 * 35, 55, 60, 70,
* 80, 90, 100, 120, 2 * 140, 160, 2 * 180, 2 * 200, 220, 250, 2 * 300, 2 * 350, 2 * 16,
* 2 * 40, 60, 2 * 70, 90, 100, 120, 140, 160, 2 * 180, 200, 2 * 220, 2 * 250, 2 * 300,
* 3 * 350, 16, 18, 40, 45, 60, 70, 80, 100, 120, 2 * 140, 160, 180, 200, 220, 3 * 250,
* 300, 3 * 350, 400, 450, 18, 20, 45, 50, 70, 80, 90, 110, 3 * 140, 180, 200, 220,
* 2 * 250, 2 * 300, 3 * 350, 2 * 450, 500, 20, 22, 50, 60, 80, 90, 100, 120, 140, 160,
* 180, 200, 220, 250, 4 * 300, 350, 400, 2 * 450, 2 * 500, 22, 25, 60, 70, 90,
* 100, 120, 140, 160, 180, 200, 220, 250, 2 * 300, 3 * 350, 400, 450, 2 * 500,
* 2 * 600, 30, 35, 2 * 70, 100, 120, 140, 160, 180, 200, 220, 250, 300,
* 2 * 350, 3 * 400, 450, 500, 2 * 600, 2 * 700, 2 * 35, 80, 90, 120, 2 * 140, 180,
* 200, 220, 250, 300, 2 * 350, 400, 2 * 450, 2 * 500, 600, 3 * 700, 800, 35, 40,
* 90, 100, 140, 160, 180, 220, 250, 300, 350, 350, 400, 450, 2 * 500, 2 * 600,
* 3 * 700, 800, 2 * 900, 45, 50, 110, 120, 2 * 180, 200, 250, 300, 2 * 350,
* 400, 2 * 500, 2 * 600, 800, 700, 700, 800, 900, 2 * 1000, 1200, 50,
* 60, 120, 140, 200, 220, 250, 300, 350, 400, 450, 500, 2 * 600, 2 * 700,
* 900, 800, 900, 2 * 1000, 2 * 1200, 1400 /
DATA LMECS2 / 60, 70, 160, 180, 240, 250, 300, 400, 450, 2 * 500,
* 600, 2 * 700, 800, 2 * 900, 2 * 1000, 1200, 3 * 1400, 1600, 70, 80, 180,
* 200, 300, 2 * 350, 2 * 500, 2 * 600, 2 * 800, 900, 2 * 1000, 2 * 1200,
* 2 * 1400, 2 * 1600, 1800, 2000, 90, 100, 240, 250, 350, 400, 450, 600,
* 3 * 700, 900, 1000, 1200, 4 * 1400, 1600, 2 * 1800, 2000, 2200,
* 2500, 120, 140, 300, 350, 450, 500, 550, 700, 800, 2 * 900, 1100,
* 3 * 1400, 1600, 2 * 1800, 2000, 2200, 2 * 2500, 2 * 3000 /
C     ДОПУCKИ HA TOЛЩИНУ ЗУБA TC(TAБЛ.21)
DATA MTC /
*20, 25, 35, 40, 50, 70, 80, 100, 22, 30, 35, 45, 60, 70, 90, 120,
* 25, 30, 35, 50, 60, 70, 100, 120, 30, 35, 45, 50, 70, 80, 100, 140,
* 30, 40, 50, 60, 70, 90, 120, 140, 35, 45, 60, 70, 80, 100, 140, 160,
* 40, 50, 70, 70, 100, 140, 140, 180, 45, 60, 70, 90, 120, 140, 180, 220,
* 50, 70, 90, 100, 140, 160, 200, 250, 70, 70, 100, 120, 140, 180, 250, 300,
* 70, 100, 140, 140, 180, 220, 300, 350,
* 90, 120, 160, 180, 220, 250, 350, 450,
* 120, 140, 180, 220, 250, 350, 450, 500,
* 140, 180, 220, 300, 350, 400, 500, 700,
* 180, 220, 300, 350, 400, 500, 700, 800,
* 220, 250, 350, 450, 500, 700, 800, 1000,
* 250, 350, 450, 500, 700, 800, 1000, 1400,
* 350, 450, 500, 700, 800, 1000, 1200, 1400,
* 400, 500, 700, 800, 1000, 1200, 1400, 1800,
* 500, 700, 900, 1000, 1200, 1400, 1800, 2200,
* 700, 700, 1000, 1400, 1400, 1800, 2500, 3000 /
C     OПPEДEЛEHИE ИHДEKCOB
CCC      IF(M.LE.55.) IM = 7
IM = 7
IF(M.LE.40.) IM = 6
IF(M.LE.25.) IM = 5
IF(M.LE.16.) IM = 4
IF(M.LE.10.) IM = 3
IF(M.LE.6.3) IM = 2
IF(M.LE.3.5) IM = 1
IF(KST(1).EQ.3) IMF = IM
IF(KST(1).EQ.4) IMF = IM + 3
IF(KST(1).EQ.5) IMF = IM + 6
IF(KST(1).EQ.6) IMF = IM + 10
IF(KST(1).EQ.7) IMF = IM + 14
IF(KST(1).EQ.8) IMF = IM + 19
IF(KST(1).EQ.9) IMF = IM + 25
IF(KST(1).EQ.10) IMF = IM + 32
IF(KST(1).EQ.11) IMF = IM + 39
IF(KST(1).EQ.12) IMF = IM + 46
IF(KST(2).LE.6) IS = 1
IF(KST(2).GE.7) IS = KST(2) - 5
IF(KST4.EQ.6) IVS = IS
IF(KST4.EQ.5) IVS = IS + 2
IF(KST4.EQ.4) IVS = IS + 4
IF(KST4.EQ.3) IVS = IS + 7
IF(KST4.EQ.2) IVS = IS + 11
IF(KST4.EQ.1) IVS = IS + 17
IV = 7 - KST4
IVD = 9 - KST5
DO 1 I = 1, 2
CCCC      IF(D(I).LE.6300.) IDF = 7
IDF = 7
IF(D(I).LE.4000.) IDF = 6
IF(D(I).LE.2500.) IDF = 5
IF(D(I).LE.1600.) IDF = 4
IF(D(I).LE.800.) IDF = 3
IF(D(I).LE.400.) IDF = 2
IF(D(I).LE.125.) IDF = 1
CCCC      IF(D(I).LE.6300.) IDE = 18
IDE = 18
IF(D(I).LE.5000.) IDE = 17
IF(D(I).LE.4000.) IDE = 16
IF(D(I).LE.3150.) IDE = 15
IF(D(I).LE.2500.) IDE = 14
IF(D(I).LE.2000.) IDE = 13
IF(D(I).LE.1600.) IDE = 12
IF(D(I).LE.1250.) IDE = 11
IF(D(I).LE.1000.) IDE = 10
IF(D(I).LE.800.) IDE = 9
IF(D(I).LE.630.) IDE = 8
IF(D(I).LE.500.) IDE = 7
IF(D(I).LE.400.) IDE = 6
IF(D(I).LE.315.) IDE = 5
IF(D(I).LE.250.) IDE = 4
IF(D(I).LE.180.) IDE = 3
IF(D(I).LE.125.) IDE = 2
IF(D(I).LE.80.) IDE = 1
CCCC      IF(D(I).LE.1600.) IDW = 12
IDW = 12
IF(D(I).LE.1250.) IDW = 11
IF(D(I).LE.1000.) IDW = 10
IF(D(I).LE.800.) IDW = 9
IF(D(I).LE.630.) IDW = 8
IF(D(I).LE.500.) IDW = 7
IF(D(I).LE.400.) IDW = 6
IF(D(I).LE.315.) IDW = 5
IF(D(I).LE.250.) IDW = 4
IF(D(I).LE.180.) IDW = 3
IF(D(I).LE.125.) IDW = 2
IF(D(I).LE.80.) IDW = 1
FR(I) = MFR(IMF, IDF)
IF(FR(I).LE.800.) IFR = 21
IF(FR(I).LE.630) IFR = 20
IF(FR(I).LE.500.) IFR = 19
IF(FR(I).LE.400.) IFR = 18
IF(FR(I).LE.320.) IFR = 17
IF(FR(I).LE.250.) IFR = 16
IF(FR(I).LE.200.) IFR = 15
IF(FR(I).LE.160) IFR = 14
IF(FR(I).LE.125.) IFR = 13
IF(FR(I).LE.100.) IFR = 12
IF(FR(I).LE.80.) IFR = 11
IF(FR(I).LE.60.) IFR = 10
IF(FR(I).LE.50.) IFR = 9
IF(FR(I).LE.40.) IFR = 8
IF(FR(I).LE.32.) IFR = 7
IF(FR(I).LE.25.) IFR = 6
IF(FR(I).LE.20.) IFR = 5
IF(FR(I).LE.16.) IFR = 4
IF(FR(I).LE.12.) IFR = 3
IF(FR(I).LE.10.) IFR = 2
IF(FR(I).LE.8.) IFR = 1

//====================================================
C     Определение допусков и отклонений
EHS(I) = -MEHS(IVS, IDE) / 1000.
TH(I) = MTH(IVD, IFR) / 1000.
EWS1(I) = -MEWS1(IVS, IDW) / 1000.
EWS2(I) = -MEWS2(IFR) / 1000.
EWS(I) = EWS1(I) + EWS2(I)
TWM(I) = MTWM(IVD, IFR) / 1000.
TW(I) = MTW(IVD, IFR) / 1000.
ECS(I) = -MECS(IVS, IDE) / 1000.
TC(I) = MTC(IVD, IFR) / 1000.
1 CONTINUE
RETURN
*/
}

